function addStory(){$("#error").hide("slow");$.ajax({url:"//www.fimfiction.net/api/story.php?story="+$("#addedstory").val(),type:"GET",crossDomain:true,dataType:"jsonp"}).done(function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;if(e.error==="Invalid story id"){$("#error").html("<strong>ERROR:</strong> Could not load story. Check the Story ID and try again.");$("#error").show("slow");return}n=e.story.words;r=e.story.status;i=e.story.likes;s=e.story.dislikes;t=e.story.title;o=e.story.chapter_count;u=e.story.content_rating;a=e.story.categories.Romance;f=e.story.categories.Tragedy;l=e.story.categories.Sad;c=e.story.categories.Dark;h=e.story.categories.Comedy;p=e.story.categories.Random;d=e.story.categories.Crossover;v=e.story.categories.Adventure;m=e.story.categories["Slice of Life"];g=e.story.categories["Alternate Universe"];y=e.story.categories.Human;b=e.story.categories.Anthro;stories.push([t,n,r,i,s,o,u,[a,f,l,c,h,p,d,v,m,g,y,b]]);$("#stories").html($("#stories").html()+t+'&nbsp;<a title="Remove Story" onclick="removeStory('+stories.length+')">&#10006;</a>, ')}).fail(function(){$("#error").show("slow")});$("#addedstory").val("")}function removeStory(e){var t;stories.splice(e,1);$("#stories").html("");for(t=0;t<stories.length;t++){$("#stories").html($("#stories").html()+stories[t][0]+'&nbsp;<a title="Remove Story" onclick="removeStory('+t+')">&#10006;</a>, ')}}function clearStat(){$("#stories").html("");$("#error").hide("slow");$("#stats").hide("slow");while(stories.length>0){stories.pop()}}function stat(){var e=0,t=0,n=0,r=0,i=0,s=0,o=0,u=0,a=[["Story","Words"]],f=0,l=0,c=0,h=0,p=0,d=0,v=0,m=0,g=0,y=0,b=0,w=0,E=0,S=0,x=0,T;if($("#wpm").val()<1){$("#error").html("<strong>ERROR:</strong> Please learn how to read before using just-words.");$("#error").show("slow");return}else if($("#wpm").val()>1500){$("#error").html("<strong>ERROR:</strong> Please learn how to tell at least somewhat realistic lies before using just-words.");$("#error").show("slow");return}$("#error").hide("slow");for(T=0;T<stories.length;T++){e=e+Number(stories[T][1]);s=s+Number(stories[T][3]);o=o+Number(stories[T][4]);u=u+Number(stories[T][5]);h=h+stories[T][7][0];p=p+stories[T][7][1];d=d+stories[T][7][2];v=v+stories[T][7][3];m=m+stories[T][7][4];g=g+stories[T][7][5];y=y+stories[T][7][6];b=b+stories[T][7][7];w=w+stories[T][7][8];E=E+stories[T][7][9];S=S+stories[T][7][10];x=x+stories[T][7][11];a.push([stories[T][0],Number(stories[T][1])]);if(stories[T][2]==="Complete"){t=t+1}else if(stories[T][2]==="Incomplete"){n=n+1}else if(stories[T][2]==="On Hiatus"){r=r+1}else{i=i+1}if(stories[T][6]===0){f=f+1}else if(stories[T][6]===1){l=l+1}else{c=c+1}}$("#total_words").html(e);$("#total_chapters").html(u);if(e/275>5760){$("#word_time").html((e/$("#wpm").val()/60/60).toFixed(2)+" days")}else if(e/275>240){$("#word_time").html((e/$("#wpm").val()/60).toFixed(1)+" hours")}else{$("#word_time").html((e/$("#wpm").val()).toFixed(0)+" minutes")}$("#stats").show("slow");var N=google.visualization.arrayToDataTable([["Status","Number"],["Complete",t],["Incomplete",n],["On Hiatus",r],["Cancelled",i]]);var C={title:"Completness",legend:"none"};var k=new google.visualization.PieChart($("#stats_rating")[0]);var L=google.visualization.arrayToDataTable(a);var A={title:"Word Breakdown",legend:"none"};var O=new google.visualization.PieChart($("#stats_words_individual")[0]);var M=google.visualization.arrayToDataTable([["Likes","Number"],["Likes",s],["Dislikes",o]]);var _={title:"Likes v Dislikes",legend:"none",slices:{0:{color:"#547F1D"},1:{color:"#952525"}}};var D=new google.visualization.PieChart($("#stats_completness")[0]);var P=google.visualization.arrayToDataTable([["Rating","Number"],["Everyone",f],["Teen",l],["Mature",c]]);var H={title:"Ratings",legend:"none",slices:{0:{color:"#89C738"},1:{color:"#C78238"},2:{color:"#C73838"}}};var B=new google.visualization.PieChart($("#stats_ratings")[0]);var j=google.visualization.arrayToDataTable([["Genre","Number"],["Romance",h],["Tragedy",p],["Sad",d],["Dark",v],["Comedy",m],["Random",g],["Crossover",y],["Adventure",b],["Slice of Life",w],["Alternate Universe",E],["Human",S],["Anthro",x]]);var F={title:"Genres",legend:"none",slices:{0:{color:"#773DB3"},1:{color:"#D95E87"},2:{color:"#E09D2B"},3:{color:"#982323"},4:{color:"#CAA600"},5:{color:"#3F74CE"},6:{color:"#45C950"},7:{color:"#3F49CF"},8:{color:"#47B8A0"},9:{color:"#888"},10:{color:"#B5835A"},11:{color:"#B5695A"}}};var I=new google.visualization.PieChart($("#stats_genres")[0]);k.draw(N,C);O.draw(L,A);D.draw(M,_);B.draw(P,H);I.draw(j,F)}function loadSample(){stories.push(["Sample Story 1",66711,"Cancelled",1,24,10,2,[true,false,false,false,true,false,false,false,true,false,false,false]]);stories.push(["Sample Story 2",2997,"Complete",12,1,1,0,[false,true,false,false,false,true,false,false,false,true,false,false]]);stories.push(["Sample Story 3",271828,"Incomplete",3141,592,123,1,[false,false,true,false,false,false,true,false,false,false,true,false]]);stories.push(["Sample Story 4",0,"On Hiatus",0,5,0,0,[false,false,false,true,false,false,false,true,false,false,false,true]]);for(i=0;i<stories.length;i++){$("#stories").html($("#stories").html()+stories[i][0]+'&nbsp;<a title="Remove Story" onclick="removeStory('+i+')">&#10006;</a>, ')}stat()}var stories=[]
